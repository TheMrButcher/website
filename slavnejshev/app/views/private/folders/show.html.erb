<% provide(:title, @folder.full_path) %>

<div class="row">
  <div class="col-md-12">
    <%= render partial: 'shared/path', locals: { full_path: @folder.full_path  } %>
  </div>
  <div class="col-md-10 offset-md-1">
    <div class="obj-info-block">
      <h3 class="text-xs-center"><%= t('.obj_name') + ' "' + @folder.name + '"' %></h3>
      <%= render partial: 'shared/tags', locals: { obj: @folder  } %>
    </div>
    <div class="obj-content-block">
      <div class="add-block-header">
        <button class="btn btn-secondary" data-toggle="collapse" href="#add-folder-form">
          <%= t('.subfolder_header_button') %>
        </button>
      </div>
      <div id="add-folder-form" class="add-block-form collapse">
        <%= form_for(:private_folder, url: private_folders_path, html: { class: 'form-inline' }) do |f| %>
          <%= f.hidden_field :owner, value: @folder.owner.name %>
          <%= f.hidden_field :parent_id, value: @folder.id %>
          <%= f.hidden_field :public, value: (@folder.public? ? '1' : '0') %>
          <%= f.hidden_field :stores_panoramas, value: (@folder.stores_panoramas? ? '1' : '0') %>
          
          <div class="form-group">
            <%= f.label :name, t('.subfolder_label') %>
            <%= f.text_field :name, class: 'form-control' %>
          </div>
            
          <%= f.submit t('.submit_subfolder'), class: 'btn btn-primary' %>
        <% end %>
      </div>
      
      <% if @folder.stores_panoramas? %>
        <div class="add-block-header">
          <button class="btn btn-secondary" data-toggle="collapse" href="#add-pano-form">
            <%= t('.panorama_header_button') %>
          </button>
        </div>
        <div id="add-pano-form" class="add-block-form collapse">
          <%= form_for(:private_panorama, url: private_panoramas_path, html: { class: 'form-inline' }) do |f| %>
            <%= f.hidden_field :folder_id, value: @folder.id %>
          
            <div class="form-group">
              <%= f.label :name, t('.panorama_label') %>
              <%= f.text_field :name, class: 'form-control' %>
            </div>
            
            <%= f.submit t('.submit_panorama'), class: 'btn btn-primary' %>
          <% end %>
        </div>
      <% end %>
      
      <div class="row">
        <% @folder.children.each do |folder| %>
          <%= render partial: 'entity', locals: { entity: folder, type: :folder, path: private_files_path(folder) } %>
        <% end %>
        <% @folder.panoramas.each do |panorama| %>
          <%= render partial: 'entity', locals: { entity: panorama, type: :panorama, path: private_show_pano_path(panorama) } %>
        <% end %>
      </div>
    </div>
  </div>
</div>
